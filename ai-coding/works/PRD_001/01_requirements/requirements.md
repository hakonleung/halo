# 可视化模块需求规格

> PRD_001 | 阶段 01-需求澄清

## 1. 背景与痛点

### 背景
NEO-LOG 是一个 AI 驱动的个人生活追踪系统，用户已可通过 Chatbot 和表单记录行为、目标和随手记。目前 Dashboard 页面仅展示基础欢迎信息，缺乏数据可视化能力。

### 痛点
| 痛点 | 描述 |
|------|------|
| 数据黑箱 | 用户无法直观看到自己的行为趋势和习惯模式 |
| 缺乏激励 | 无连续打卡、目标进度等激励性视觉反馈 |
| 分析困难 | 无法快速识别行为规律和异常 |
| 信息分散 | 需要在多个页面间切换查看不同类型数据 |

## 2. 用户定义

| 角色 | 特征 | 核心诉求 |
|------|------|----------|
| 效率追踪者 | 每日使用，关注习惯养成 | 快速查看今日状态，连续打卡激励 |
| 数据分析者 | 定期深度分析，关注长期趋势 | 多维度图表，自定义时间范围 |
| 目标驱动者 | 以目标为中心，关注进度 | 目标进度可视化，达成率统计 |

## 3. 功能范围

### Must Have (必须实现)

| 功能 | 说明 |
|------|------|
| 概览卡片组 | 今日行为统计、目标达成率、连续活跃天数、本周对比 |
| 行为趋势图 | 折线图展示行为频次随时间变化，支持按行为类型筛选 |
| 活跃度热力图 | GitHub 风格日历热力图，展示全年活跃度分布 |
| 目标进度环 | 环形进度条展示各目标完成进度 |
| 时间范围选择器 | 今日/7天/30天/90天/自定义日期范围 |

### Nice to Have (可选实现)

| 功能 | 说明 |
|------|------|
| 分类饼图 | 行为类型分布占比 |
| 柱状对比图 | 本周 vs 上周、本月 vs 上月对比 |
| 图表钻取 | 点击图表元素跳转至详情 |
| 数据导出 | 导出图表为 PNG 或数据为 CSV |
| 迷你趋势线 | 卡片内嵌迷你趋势 Sparkline |

### 不做 (Out of Scope)

| 功能 | 原因 |
|------|------|
| 实时数据流 | 非实时系统，无需 WebSocket 推送 |
| 3D 图表 | 复杂度高，与赛博朋克风格不匹配 |
| 多用户对比 | 个人系统，无社交功能 |
| 预测分析 | 属于 AI 分析模块，本期不涉及 |

## 4. 使用场景

### 场景 1: 每日快速查看
- **触发**: 用户登录后进入 Dashboard
- **流程**: 首屏看到今日统计卡片 → 确认连续活跃天数 → 扫一眼目标进度
- **时长**: < 10 秒

### 场景 2: 周度复盘分析
- **触发**: 用户每周末想回顾本周表现
- **流程**: 切换时间范围至 7 天 → 查看趋势图 → 对比上周数据 → 分析行为分布
- **时长**: 2-5 分钟

### 场景 3: 目标进度检查
- **触发**: 用户想了解目标完成情况
- **流程**: 查看目标进度环 → 点击特定目标 → 查看关联行为详情
- **时长**: 1-2 分钟

### 场景 4: 年度活跃度回顾
- **触发**: 用户想看全年活跃趋势
- **流程**: 查看热力图 → 识别活跃高峰/低谷 → 点击某天查看详情
- **时长**: 1-3 分钟

## 5. 边界条件

| 边界 | 处理方式 |
|------|----------|
| 无数据 | 展示空状态引导，提示用户开始记录 |
| 数据量大 (>1年) | 热力图仅展示最近 12 个月，趋势图按周/月聚合 |
| 目标为空 | 目标进度区域展示创建目标引导 |
| 加载慢 | 骨架屏 + 分块加载（卡片先加载，图表后加载） |
| 移动端 | 单列布局，图表可横向滚动 |

## 6. 成功指标

| 指标 | 目标值 | 测量方式 |
|------|--------|----------|
| 首屏加载时间 | < 2 秒 | Lighthouse 测量 |
| 图表渲染时间 | < 500ms | Performance API |
| 用户停留时长 | > 30 秒 | 埋点统计 |
| 功能完整度 | 100% Must Have | 功能清单勾选 |
| 类型安全 | 0 TypeScript 错误 | `tsc --noEmit` |
| 代码质量 | 0 Lint 错误 | `pnpm lint` |

## 7. 约束与假设

### 技术约束
- 必须使用 Chakra UI 组件，禁用原生 HTML 标签
- 图表库需支持响应式和深色主题
- 遵循赛博朋克 UI 规范（矩阵绿主色、故障动画等）

### 假设
- 用户已登录且有数据记录
- 后端已有行为记录和目标的 API
- 数据量在合理范围内（< 10000 条记录/年）

### 依赖
- `neolog_behavior_records` 表 - 行为记录数据
- `neolog_goals` 表 - 目标数据
- `neolog_notes` 表 - 随手记数据（可选展示）
